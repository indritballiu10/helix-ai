/***************
  PYETJET
****************/
const questions = [];

// Shembuj pyetjesh
function addQuestion(q,a){ questions.push({q:q.toLowerCase(),a}); }

// -- Shto te gjitha pyetjet qe me dhurove, me c/e normale --
addQuestion("cfare eshte adn", "ADN eshte materiali gjenetik qe mban informacionin per te gjitha qelizat e organizmit.");
addQuestion("si formohet adn", "ADN formohet nga zinxhire polinukleotidesh te perbere nga bazat adenina, timina, guanina dhe citozina.");
addQuestion("struktura e adn", "ADN ka strukture helike dyfish, nje spirale e dyfishte.");
addQuestion("mutacionet gjenetike", "Mutacionet jane ndryshime ne sekuencen e ADN qe mund te ndikojne ne gjenet.");
addQuestion("replikimi i adn", "Replikimi i ADN eshte procesi ku ADN kopjohet perpara ndarjes se qelizave.");
addQuestion("bazat e adn", "Bazat e ADN jane adenina (A), timina (T), guanina (G) dhe citozina (C).");
addQuestion("zinxhir i dyfishem", "ADN ka dy zinxhire antiparalele qe lidhen me njeri-tjetrin me lidhje hidrogjeni.");
addQuestion("gjenet", "Gjenet jane segmentet e ADN qe kodojne per proteina ose funksione specifike.");
addQuestion("kromozomet", "Kromozomet jane struktura ne berthame qe mbajne ADN dhe informacionin gjenetik.");
addQuestion("gjenetika", "Gjenetika studion si trashegohen tiparet biologjike nga nje brez tek tjetri.");
addQuestion("enzimat ne replikim", "Enzimat si ADN polymeraza ndihmojne ne kopjimin e ADN-se.");
addQuestion("cili eshte funksioni i timines", "Timina lidhet me adeninen per te formuar lidhje hidrogjeni dhe stabilizon heliken.");
addQuestion("cili eshte funksioni i adenines", "Adenina lidhet me timinen dhe merr pjese ne kodimin e informacionit gjenetik.");
addQuestion("cili eshte funksioni i guanines", "Guanina lidhet me citozinen dhe formon lidhje hidrogjeni ne ADN.");
addQuestion("cili eshte funksioni i citozines", "Citozina lidhet me guaninen dhe stabilizon strukturen e ADN.");
addQuestion("si ndahen kromozomet", "Gjate mitozes kromozomet ndahen ne qelizat bije per te ruajtur informacionin gjenetik.");
addQuestion("pergjegjesi i replikimit", "ADN polymeraza eshte enzima kryesore qe kopjon ADN-ne.");
addQuestion("mutacionet spontane", "Mutacionet spontane ndodhin pa ndikim te jashtem, shpesh gjate replikimit.");
addQuestion("mutacionet induktive", "Mutacionet induktive shkaktohen nga faktore si rrezatimi ose kimikatet.");
addQuestion("tipet e mutacioneve", "Ka mutacione pikenore, insercione, delecione dhe translokacione.");
addQuestion("strukturat e kromatines", "Kromatina eshte struktura e ADN-se dhe proteinave qe formon kromozomet.");
addQuestion("histonet", "Histonet jane proteina qe mbeshtesin dhe mbeshtjellin ADN-ne ne kromatine.");
addQuestion("codoni", "Codoni eshte grup prej tre bazash qe kodon per nje aminoacid ne proteine.");
addQuestion("gjenom", "Gjenomi eshte e gjithe materiali gjenetik i nje organizmi.");
addQuestion("rna dhe adn", "RNA transmeton informacionin nga ADN per sintezen e proteinave.");
addQuestion("tipet e rna", "mRNA, tRNA dhe rRNA kane funksione te ndryshme ne sintezen e proteinave.");
addQuestion("transkriptimi", "Procesi ku informacioni i ADN kopjohet ne mRNA.");
addQuestion("translacioni", "Procesi ku mRNA perdoret per te prodhuar proteinat ne ribozome.");
addQuestion("mutacionet ne gjenet", "Ndryshimet ne sekuencen e ADN qe mund te ndryshojne proteinat.");
addQuestion("rekombinimi gjenetik", "Shkembimi i informacionit gjenetik gjate meioses per te rritur variacionin.");
addQuestion("tipet e replikimit", "Replikimi bidirectional dhe semikonservativ.");
addQuestion("funksioni i helikazes", "Helikaza çan lidhjet hidrogjeni per te hapur heliken e ADN.");
addQuestion("funksioni i ligazes", "Ligaza lidh fragmentet e ADN gjate replikimit.");
addQuestion("funksioni i primazes", "Primaza krijon primere per ADN polymerazen.");
addQuestion("cili eshte ADN-ja e mitokondrise", "ADN mitokondriale eshte ADN e veçante e mitokondrive qe trashegohet nga nana.");
addQuestion("tipet e ADN", "Ka ADN berthamore dhe ADN mitokondriale.");
addQuestion("trashegimia mendeliane", "Rregullat e Mendelit shpjegojne si trashegohen tiparet nga nje brez tek tjetri.");
addQuestion("efekti i mutacioneve", "Mutacionet mund te jene neutrale, te dobishme ose te demshme.");
addQuestion("ADN deshtuar", "Kur replikimi ose riparimi deshton mund te ndodhin mutacione.");
addQuestion("tipet e bazave", "Bazat e ADN jane purinat (A,G) dhe pirimidinat (T,C).");
addQuestion("strukturat e ADN te vecanta", "ADN ka struktura helike, loop-e, hairpins dhe formacione te tjera te dyfishta.");
addQuestion("gjenet dominues dhe recesive", "Gjenet dominues shprehen edhe ne nje kopje, recesive duhen dy kopje.");
addQuestion("polimorfizmi gjenetik", "Variacioni ne sekuencen e ADN midis individeve te nje specie.");
addQuestion("epigenetika", "Ndryshime ne shprehjen e gjenit qe nuk ndryshojne sekuencen e ADN.");
addQuestion("methylimi i ADN", "Methylimi eshte modifikim kimik qe mund te fike shprehjen e gjeneve.");
addQuestion("acetilimi i histonave", "Modifikim qe hap kromatine dhe rrit shprehjen e gjeneve.");
addQuestion("roli i ADN ne qeliza", "Ruajt informacionin gjenetik dhe udhezon prodhimin e proteinave.");
addQuestion("replikimi semikonservativ", "Cdo molekule e re ka nje zinxhir te vjeter dhe nje te ri.");
addQuestion("celular checkpoints", "Kontrollet qelizore sigurojne qe ADN eshte e sakte para ndarjes.");
addQuestion("funksioni i telomeraze", "Telomeraza riparon fundet e kromozomeve per te parandaluar shkurtesimin.");
addQuestion("strukturat e helikes", "ADN formon helike dyfishe te djathte B-DNA.");
addQuestion("tipet e kromozomeve", "Kromozomet jane autosome dhe kromozome seksuale.");
addQuestion("hapet e riparimit te ADN", "Riparimi i ADN perfshin zbulimin e demtimit, heqjen e pjeses se demtuar dhe zevendesimin.");
addQuestion("funksioni i polymerazes", "ADN polymeraza shton nucleotide ne zinxhirin e ri te ADN.");
addQuestion("qelizat somatike dhe germinale", "Qelizat somatike nuk trashegojne mutacionet, germinalet po.");
addQuestion("strukturat e gjenomit", "Gjenomi perfshin te gjithe ADN-ne, gjene dhe ADN jo-kodues.");
addQuestion("tipet e mutacioneve pikenore", "Ndryshimi i nje baze te vetme qe mund te ndryshoje proteinën.");
addQuestion("tipet e translokacioneve", "Fragmentet e kromozomeve mund te ndryshojne vendin midis kromozomeve.");
addQuestion("tipet e delecioneve", "Humbja e nje segmenti te ADN-se ne kromozome.");
addQuestion("tipet e insercioneve", "Shtimi i nje segmenti te ADN-se ne kromozome.");
addQuestion("funksioni i tRNA", "tRNA sjell aminoacidet per te ndertuar proteinat ne ribozome.");
addQuestion("funksioni i mRNA", "mRNA transmeton informacionin nga ADN per sintezen e proteinave.");
addQuestion("funksioni i rRNA", "rRNA eshte komponent kryesor i ribozomes dhe ndihmon ne translacion.");
addQuestion("shenjat e promotorit", "Zona e ADN qe nxit transkriptimin e nje gjeni.");
addQuestion("enzimat e riparimit te ADN", "Enzimat zbulojne dhe riparojne gabimet ne ADN.");
addQuestion("funksioni i ligazes ne ADN", "Ligaza lidh fragmentet Okazaki gjate replikimit.");
addQuestion("origjina e replikimit", "Pika ne ADN ku fillon procesi i replikimit.");
addQuestion("tipet e organizimeve ADN", "Eukariotet kane kromozome lineare, prokariotet rrethore.");
addQuestion("funksioni i helicazes", "Helikaza hap heliken e ADN per te mundesuar replikimin.");
addQuestion("rendi i bazave", "Sekuencia e bazave percakton kodimin per proteinat.");
addQuestion("funksioni i intronave", "Intronat jane pjese jo-kodues te gjeneve qe hiqen gjate splicing.");
addQuestion("funksioni i eksonave", "Eksonat kodojne per proteinat dhe ruhen ne mRNA.");
addQuestion("splicing i mRNA", "Procesi ku intronat hiqen dhe eksonat bashkohen.");
addQuestion("tipet e RNA", "mRNA, tRNA, rRNA dhe microRNA.");
addQuestion("funksioni i microRNA", "Rregullon shprehjen e gjeneve duke ndikuar ne mRNA.");
addQuestion("epistaza", "Kur nje gjen ndikon ne shprehjen e nje gjen tjeter.");
addQuestion("pleiotropia", "Nje gjen mund te ndikojë ne shume tipare te ndryshme.");
addQuestion("gjenet recesive dhe dominues", "Dominues shprehen edhe ne nje kopje, recesive duhen dy kopje.");
addQuestion("heterozigot dhe homozigot", "Heterozigot ka dy alele te ndryshme, homozigot ka dy te njejta.");
addQuestion("tipet e ADN e vecante", "ADN mitokondriale, plastidiale dhe berthamore.");
addQuestion("mutacionet e dobishme", "Mund te japin avantazh per organizmin.");
addQuestion("mutacionet e demshme", "Mund te shkaktojne semundje ose probleme qelizore.");
addQuestion("mutacionet neutrale", "Nuk kane efekt te dukshëm ne organizëm.");
addQuestion("funksioni i ADN mitokondriale", "Mbështet prodhimin e energjisë dhe trashegohet nga nana.");
addQuestion("rekombinimi gjene", "Shkembimi i pjeseve te ADN gjate meioses per variacionin gjenetik.");
addQuestion("tipet e replikimit semikonservativ", "Secila helike e re ka nje zinxhir te vjeter dhe nje te ri.");
addQuestion("funksioni i telomereve", "Mbrotur fundet e kromozomeve nga degradasioni.");
addQuestion("riparimi i gabimeve", "Sistemet BER, NER dhe mismatch riparojne gabimet ne ADN.");
addQuestion("tipet e helikes", "B-DNA, A-DNA, Z-DNA me karakteristika te ndryshme.");
addQuestion("funksioni i codonit", "Secili codon kodon per nje aminoacid specifik ne proteine.");
addQuestion("funksioni i gjenomit human", "Perben te gjithe ADN-ne e njeriut, rreth 3 miliard baza.");
addQuestion("variacioni gjenetik", "Ndryshimet ne sekuencen e ADN qe japin tipare te ndryshme.");
addQuestion("funksioni i kromatines", "Organizon ADN-ne ne berthame dhe kontrollon shprehjen e gjeneve.");
// Mund te shtoni pyetje tjera sipas nevojes

/***************
  FUZZY MATCH
****************/
function scoreMatch(input, text){
  input=input.toLowerCase(); text=text.toLowerCase();
  if(text.includes(input)) return 100;
  let score=0;
  for(let ch of input){ if(text.includes(ch)) score+=5; }
  return score;
}

/***************
  SEARCH LOGIC
****************/
const input=document.getElementById("searchInput");
const btn=document.getElementById("searchBtn");
const sugg=document.getElementById("suggestions");
const answer=document.getElementById("answer");

function updateSuggestions(){
  const val=input.value.trim();
  sugg.innerHTML="";
  if(!val) return;

  const results=questions
    .map(q=>({...q,score:scoreMatch(val,q.q)}))
    .filter(q=>q.score>10)
    .sort((a,b)=>b.score-a.score)
    .slice(0,8);

  results.forEach(r=>{
    const div=document.createElement("div");
    div.className="suggestion";
    div.textContent=r.q;
    div.onclick=()=>{
      input.value=r.q;
      answer.textContent=r.a;
      sugg.innerHTML="";
    };
    sugg.appendChild(div);
  });
}

input.addEventListener("input",updateSuggestions);
input.addEventListener("keydown",e=>{ if(e.key==="Enter") btn.click(); });

btn.onclick=()=>{
  const val=input.value.toLowerCase();
  const found=questions.find(q=>q.q.includes(val));
  answer.textContent=found?found.a:"Nuk u gjet pergjigje.";
  sugg.innerHTML="";
};

/***************
  BACKGROUND YJE
****************/
const starCanvas=document.getElementById("stars");
const sctx=starCanvas.getContext("2d");

function resizeStars(){ starCanvas.width=innerWidth; starCanvas.height=innerHeight; }
resizeStars();
window.onresize=resizeStars;

const stars=Array.from({length:200},()=>({x:Math.random()*innerWidth,y:Math.random()*innerHeight,r:Math.random()*2}));

function drawStars(){
  sctx.clearRect(0,0,innerWidth,innerHeight);
  sctx.fillStyle="white";
  stars.forEach(s=>{ sctx.beginPath(); sctx.arc(s.x,s.y,s.r,0,Math.PI*2); sctx.fill(); });
  requestAnimationFrame(drawStars);
}
drawStars();

/***************
  ADN ANIMATION
****************/
const container=document.getElementById("dna-container");
const scene=new THREE.Scene();
const camera=new THREE.PerspectiveCamera(45,container.clientWidth/container.clientHeight,0.1,1000);
camera.position.z=25;

const renderer=new THREE.WebGLRenderer({alpha:true});
renderer.setSize(container.clientWidth,container.clientHeight);
container.appendChild(renderer.domElement);

const group=new THREE.Group();
scene.add(group);

const points=30, radius=4;
const spheres1=[], spheres2=[], bonds=[];
const mat1=new THREE.MeshBasicMaterial({color:0x00ffff});
const mat2=new THREE.MeshBasicMaterial({color:0xff00ff});
const bondMat=new THREE.MeshBasicMaterial({color:0xffffff});

for(let i=0;i<points;i++){
  const a=i*0.4;
  const y=i*0.4 - 6;

  const s1=new THREE.Mesh(new THREE.SphereGeometry(0.3),mat1);
  const s2=new THREE.Mesh(new THREE.SphereGeometry(0.3),mat2);

  s1.position.set(Math.cos(a)*radius,y,Math.sin(a)*radius);
  s2.position.set(Math.cos(a+Math.PI)*radius,y,Math.sin(a+Math.PI)*radius);

  const bond=new THREE.Mesh(new THREE.CylinderGeometry(0.05,0.05,1),bondMat);
  const mid=new THREE.Vector3().addVectors(s1.position,s2.position).multiplyScalar(0.5);
  bond.position.copy(mid);
  bond.lookAt(s2.position);
  bond.scale.y=s1.position.distanceTo(s2.position);
  bond.rotateX(Math.PI/2);

  group.add(s1,s2,bond);
  spheres1.push(s1); spheres2.push(s2); bonds.push(bond);
}

function animateDNA(){
  requestAnimationFrame(animateDNA);
  group.rotation.y += 0.01; // vetem Y
  renderer.render(scene,camera);
}
animateDNA();